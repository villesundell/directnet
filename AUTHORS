The entirety of this code was written by Gregor Richards
